from distutils.core import setup, Extension
import glob

# Set default include directories and data files
include_dirs = ['@top_srcdir@/include']
data_files   = glob.glob('@top_srcdir@/pyext/*.i')
libraries    = ['gamma']

# Add cfitsio library only if available
if '@WITH_CFITSIO_TRUE@' != '#':
    print "Link cfitsio into Python bindings."
    libraries.append('cfitsio')

# Add instrument specific include directories and data files
if '@WITH_INST_MWL_TRUE@' != '#':
    print "Include multi-wavelength interface in gammalib Python bindings."
    include_dirs.append('@top_srcdir@/inst/mwl/include')
    data_files.extend(glob.glob('@top_srcdir@/inst/mwl/pyext/*.i'))
if '@WITH_INST_CTA_TRUE@' != '#':
    print "Include CTA instrument interface in gammalib Python bindings."
    include_dirs.append('@top_srcdir@/inst/cta/include')
    data_files.extend(glob.glob('@top_srcdir@/inst/cta/pyext/*.i'))
if '@WITH_INST_LAT_TRUE@' != '#':
    print "Include Fermi/LAT instrument interface in gammalib Python bindings."
    include_dirs.append('@top_srcdir@/inst/lat/include')
    data_files.extend(glob.glob('@top_srcdir@/inst/lat/pyext/*.i'))

# Setup
setup(name='@PACKAGE_NAME@',
      version='@PACKAGE_VERSION@',
      description='gammalib Python bindings',
      author='Jurgen Knodlseder',
      author_email='@PACKAGE_BUGREPORT@',
      url='http://gammalib.sourceforge.net/',
      py_modules=['gammalib'],
      ext_modules=[Extension('_gammalib', ['gammalib_wrap.cpp'],
                             include_dirs=include_dirs,
                             library_dirs=['../src/.libs'],
                             libraries=libraries,
                             runtime_library_dirs=['@prefix@/lib'])],
                             data_files=[('@prefix@/share/gammalib/swig', data_files)],
      )
